<!DOCTYPE html>
<html>

    <head>
        <title>NCEA - Staff Missing Info</title>
        ~[wc:commonscripts]
        <link href="/images/css/screen.css" rel="stylesheet" media="screen">
        <link href="/images/css/print.css" rel="stylesheet" media="print">
        ~[wc:pscb_init]
    </head>

    <body>
        ~[wc:admin_header_frame_css]
        <!-- breadcrumb start --><a href="/admin/home.html" target="_top">Start Page</a> &gt; <a
            href="/admin/reports_pscb/pscb_home.html">PSCB Custom Reports</a> &gt; <a
            href="/admin/reports_pscb/pscb_ncea.html">NCEA</a> &gt; NCEA - Staff Missing Info
        <!-- breadcrumb end -->~[wc:admin_navigation_frame_css]

        <!-- Start of Results -->
        <h1>NCEA - Staff Missing Info</h1>
        <div class="box-round">
            <h2>NCEA - Staff Missing Info</h2>
            <table border="0" cellspacing="0" cellpadding="4" align="center" class="tablesorter grid" id="results">
                <thead>
                    <tr>
                        <th class="left">Staff Name</th>
                        <th class="left">Exclude from NCEA</th>
                        <th class="left">Gender</th>
                        <th class="left">Ethnicity</th>
                        <th class="left">Race</th>
                        <th class="left">Religion</th>
                        <th class="left">Staff Type</th>
                        <th class="left">FTE</th>
                        <th class="left">School</th>
                    </tr>
                </thead>
                <tbody>
                    ~[tlist_sql;
                    select
                    dcid,
                    lastfirst,
                    CASE
                    WHEN EXCLUDE_FROM_NCEA IS NULL THEN '#ffb3ba'
                    ELSE ''
                    END excludeHighlight,
                    EXCLUDE_FROM_NCEA,
                    CASE
                    WHEN GENDER IS NULL THEN '#ffdfba'
                    ELSE ''
                    END genderHighlight,
                    GENDER,
                    CASE
                    WHEN ETHNICITY IS NULL THEN '#ffffba'
                    ELSE ''
                    END ETHNICITYHighlight,
                    ETHNICITY,
                    CASE WHEN RACE IS NULL THEN '#baffc9'
                    ELSE ''
                    END raceHighlight,
                    RACE,
                    CASE
                    WHEN religiousaffiliation IS NULL THEN '#bae1ff'
                    ELSE ''
                    END religiousaffiliationHighlight,
                    religiousaffiliation,
                    CASE
                    WHEN STAFF_TYPE IS NULL THEN '#ffb3ba'
                    ELSE ''
                    END STAFF_TYPEHighlight,
                    STAFF_TYPE,
                    CASE
                    WHEN FTE IS NULL THEN '#ffdfba'
                    ELSE ''
                    END FTEHighlight,
                    FTE,
                    schoolname
                    from
                    (select DISTINCT
                    schools.name as schoolname,
                    schoolstaff.schoolid,
                    schoolstaff.dcid,
                    --schoolstaff.users_dcid,
                    --schoolstaff.status,
                    users.last_name,
                    users.first_name,
                    users.lastfirst,
                    CASE
                    WHEN TO_CHAR(s_ssf_ncea_x.excludefromncea_tf) = '1' then 'Excluded from NCEA'
                    WHEN TO_CHAR(s_ssf_ncea_x.excludefromncea_tf) = '0' then 'Included in NCEA'
                    ELSE TO_CHAR(s_ssf_ncea_x.excludefromncea_tf)
                    END as EXCLUDE_FROM_NCEA,
                    CASE
                    WHEN UPPER(userscorefields.gender) = 'F' then 'Female'
                    WHEN UPPER(userscorefields.gender) = 'M' then 'Male'
                    ELSE userscorefields.gender
                    END as GENDER,
                    CASE
                    WHEN s_usr_ncea_x.religiousaffiliation = 'C' then 'Catholic'
                    WHEN s_usr_ncea_x.religiousaffiliation = 'N' then 'Non-Catholic'
                    ELSE s_usr_ncea_x.religiousaffiliation
                    END as religiousaffiliation,
                    CASE
                    WHEN TO_CHAR(users.fedethnicity) = '1' then 'Hispanic/Latino'
                    WHEN TO_CHAR(users.fedethnicity) = '0' then 'Not Hispanic/Latino'
                    ELSE TO_CHAR(users.fedethnicity)
                    END as ETHNICITY,
                    LISTAGG(teacherrace.racecd,', ') WITHIN GROUP (ORDER BY teacherrace.racecd) OVER (PARTITION BY
                    schoolstaff.dcid) RACE,
                    CASE
                    WHEN s_usr_ncea_x.religiousclergylay = 'C' then 'Clergy'
                    WHEN s_usr_ncea_x.religiousclergylay = 'R' then 'Relgious'
                    WHEN s_usr_ncea_x.religiousclergylay = 'L' then 'Lay'
                    ELSE s_usr_ncea_x.religiousclergylay
                    END as STAFF_TYPE,
                    CASE
                    WHEN S_SSF_NCEA_X.FTE_CODE = 'FT' then 'Full-Time'
                    WHEN S_SSF_NCEA_X.FTE_CODE = 'PT' then 'Part-Time'
                    ELSE S_SSF_NCEA_X.FTE_CODE
                    END as FTE,
                    teacherrace.teacherid
                    from schoolstaff
                    inner join users
                    on users.dcid = schoolstaff.users_dcid
                    left join person
                    on person.dcid = users.dcid
                    left join s_ssf_ncea_x
                    on s_ssf_ncea_x.schoolstaffdcid = schoolstaff.dcid
                    left join teacherrace
                    on teacherrace.teacherid = schoolstaff.id
                    left join schools
                    on schools.school_number = schoolstaff.schoolid
                    left join s_usr_ncea_x
                    on s_usr_ncea_x.usersdcid = users.DCID
                    left join userscorefields
                    on userscorefields.usersdcid = users.dcid
                    where
                    status = '1' and
                    schoolid <> '0'
                        ~[if.is.a.school] AND schoolid = ~(curschoolid) [/if.is.a.school]
                        and (s_ssf_ncea_x.excludefromncea_tf = '0'
                        or s_ssf_ncea_x.excludefromncea_tf IS NULL)) a
                        where exclude_from_ncea is null
                        or gender is null
                        or religiousaffiliation is null
                        or race is null
                        or staff_type is null
                        or fte is null
                        Order BY schoolname, last_name, first_name
                        ;alternatecolor;
                        <tr>
                            <td colspan="100%">All staff have NCEA values.</td>
                        </tr>]
                        <tr class="Record">
                            <td><a href="/admin/faculty/facultyNCEA.html?frn=005~(dcid;t)"
                                    target="_blank">~(staffname;t)</a>
                            <td style="background-color:~(excludeHighlight;t);">~(exclude;t)</td>
                            <td style="background-color:~(genderHighlight;t);">~(gender;t)</td>
                            <td style="background-color:~(ethnicityHighlight;t);">~(ethnicity;t)</td>
                            <td style="background-color:~(raceHighlight;t);">~(race;t)</td>
                            <td style="background-color:~(religionHlight;t);">~(religion;t)</td>
                            <td style="background-color:~(staffHighlight;t);">~(stafftype;t)</td>
                            <td style="background-color:~(fteHighlight;t);">~(fte;t)</td>
                            <td>~(school;t)</td>
                        </tr>
                        [/tlist_sql]
                </tbody>
            </table>
        </div>
        <!-- End of results -->
        <div style="clear: both;">
            <p>
                <center>Report generated at ~[time] on ~[date]</center>
            </p>
        </div>
        ~[wc:admin_footer_frame_css]
    </body>

</html>