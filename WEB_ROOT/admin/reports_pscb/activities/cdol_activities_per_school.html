<html>

    <!-- non framed -->

    <head>
        <title>Activities Per School</title>
        ~[wc:commonscripts]
        <link href="/images/css/screen.css" rel="stylesheet" media="screen">
        <link href="/images/css/print.css" rel="stylesheet" media="print">
        ~[wc:pscb_init]
    </head>

    <body>
        ~[wc:admin_header_frame_css]
        <!-- breadcrumb start --><a href="/admin/home.html" target="_top">Start Page</a> &gt; <a
            href="/admin/reports_pscb/pscb_home.html" target="_top">PSCB Custom Reports</a> &gt; <a
            href="/admin/reports_pscb/pscb_activites.html" target="_top">Activities</a> &gt; Activity Membership List
        <!-- breadcrumb end -->~[wc:admin_navigation_frame_css]

        <!-- Begin report filters-->
        <h1>Activities Per School</h1>
        <div class="box-round">
            <table class="tablesorter grid" id="results">
                <thead>
                    <tr>
                        <th class="left">School</th>
                        <th class="left">Activity</th>
                        <th class="right">Count</th>
                    </tr>
                </thead>
                <tbody>
                    ~[tlist_sql;
                    SELECT DISTINCT
                    activity,
                    name,
                    count(id)
                    FROM (
                    SELECT
                    students.id,
                    Students.LastFirst,
                    Gen.Name AS Activity,
                    PS_CustomFields.GetStudentsCF(Students.ID,Gen.Value) AS Enrolled_in_Activity,
                    schools.name
                    FROM
                    Students
                    JOIN Gen ON Gen.cat='activity'
                    JOIN schools on students.schoolid = schools.school_number
                    WHERE
                    Students.Enroll_Status = 0
                    AND
                    PS_CustomFields.GetStudentsCF(Students.ID,Gen.Value) IS NOT NULL
                    ~[if.is.a.school] AND Students.schoolid = ~(curschoolid) [/if.is.a.school]
                    ORDER BY
                    schools.name,
                    Students.LastFirst,
                    Gen.Name
                    )
                    GROUP BY name, activity
                    Order by name, activity
                    ;alternatecolor;nonemessage=
                    <tr nodata>
                        <td colspan="100%">No Records Found.</td>
                    </tr>]
                    <tr class="Record" d>
                        <td>~(school)</td>
                        <td>~(activity)</td>
                        <td>~(count)</td>
                    </tr>
                    [/tlist_sql]
                </tbody>
            </table>
        </div>

        <!-- End of results -->
        <div style="clear: both;">
            <p>
                <center>Report generated at ~[time] on ~[date]</center>
            </p>
        </div>
        ~[wc:admin_footer_frame_css]
    </body>

</html>