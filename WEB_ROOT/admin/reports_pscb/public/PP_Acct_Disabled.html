<!DOCTYPE html>
<html>
    <!-- non framed -->

    <head>
        <title>Guardian/Student Account Disabled</title>
        ~[wc:commonscripts]
        <link href="/images/css/screen.css" rel="stylesheet" media="screen">
        <link href="/images/css/print.css" rel="stylesheet" media="print">
        ~[wc:pscb_init]
    </head>

    <body>
        ~[wc:admin_header_frame_css]
        <!-- breadcrumb start --><a href="/admin/home.html" target="_top">Start Page</a> &gt; <a
            href="/admin/reports_pscb/pscb_home.html" target="_top">PSCB Custom Reports</a> &gt; <a
            href="/admin/reports_pscb/pscb_public.html" target="_top">Public Portal</a> &gt; Guardian/Student Account
        Disabled
        <!-- breadcrumb end -->~[wc:admin_navigation_frame_css]
        ~[if.is.a.school]
        ~[if#sch.~[gpv:sch]=]
        ~[SetPostValue:sch=~(curschoolid)]
        [/if#sch]
        [/if.is.a.school]

        <!-- start filter parameters -->
        <form name="searchform" action="PP_Acct_Disabled.html" method="POST">
            <h1>Guardian/Student Account Disabled</h1>
            <div class="box-round">
                <h2>Report Filters</h2>
                <table border="0" cellspacing="0" cellpadding="0" class="linkDescList">
                    <thead>
                        <tr>
                            <th>School</th>
                            <th width="100%">Grade Level</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <select name="sch" id="sch" style="max-width:300px;">
                                    ~[tlist_sql;
                                    WITH
                                    Slist AS (
                                    SELECT canchangeschool as schools, schoolid FROM teachers WHERE id = ~[X:userid]
                                    ),
                                    Sel AS (
                                    SELECT sch.school_number AS school_number, sch.NAME AS School_Name FROM Slist INNER
                                    JOIN schools sch ON InStr(Slist.schools,sch.school_number) > 0 AND sch.school_number
                                    NOT IN ('999999')
                                    UNION ALL
                                    SELECT 0 AS school_number, 'All Schools' AS School_Name FROM teachers WHERE id =
                                    ~[X:userid] AND ( To_Char(CanChangeSchool) LIKE '%ascii(59)0%' OR schoolid = 0 )
                                    )
                                    SELECT school_number, CASE WHEN school_number = '~[gpv:sch]' THEN 'selected' ELSE ''
                                    END selvalue, school_name FROM Sel ORDER BY CASE WHEN school_number = 0 THEN 1 ELSE
                                    2 END, Upper(Trim(school_name))
                                    ]
                                    <option value="~(value;l)" ~(selvalue;t)>~(display;t)</option>
                                    [/tlist_sql]
                                </select>
                            </td>
                            <td><input type="text" name="gl" id="gl" value="~[gpv:gl]" size="10" /></td>
                        </tr>
                </table>
                <div class="button-row">
                    <input type="hidden" name="showData" value="1">
                    <span>
                        <font color="red">&nbsp;&nbsp;Select parameters and click submit</font>
                        </< /span>
                        <button type="submit" id="btnSubmit" name="btnSubmit" onClick="actionChange()">Submit</button>
                </div>
            </div>
        </form>
        <!-- end report filters -->

        <!-- Start of Results -->
        ~[if#showData.~[gpv:showData]=1]
        <div class="box-round">
            <h2>Parent/Guardian Account Not Created<span><label id="lblRecordCount"></label></span></h2>
            <table border="0" cellspacing="0" cellpadding="4" class="tablesorter grid" id="results">
                <thead>
                    <tr>
                        <th class="left">Student Number</th>
                        <th class="left">Last Name</th>
                        <th class="left">First Name</th>
                        <th class="left">School</th>
                        <th class="left">Grade Level</th>
                        <th class="left">Parent Access Disabled</th>
                        <th class="left">Student Access Disabled</th>
                    </tr>
                </thead>
                <tbody>
                    ~[tlist_sql;
                    SELECT
                    s.dcid
                    ,s.student_number
                    ,s.last_name
                    ,s.first_name
                    ,sch.abbreviation school
                    ,s.grade_level
                    ,CASE WHEN s.AllowWebAccess = 0 THEN 'Yes' WHEN s.AllowWebAccess = 1 THEN 'NO' END as
                    Parent_Access_Disabled
                    ,CASE WHEN s.Student_AllowWebAccess = 0 THEN 'Yes' WHEN s.Student_AllowWebAccess = 1 THEN 'NO' END
                    as Student_Access_Disabled
                    FROM
                    Students s
                    LEFT JOIN schools sch ON s.schoolid = sch.school_number
                    WHERE
                    s.enroll_status = 0
                    and (
                    s.AllowWebAccess = 0
                    OR
                    s.Student_AllowWebAccess = 0
                    )
                    ~[if#gl.~[gpv:gl]#]AND s.grade_level = ~[gpv:gl][/if#gl]
                    AND s.schoolid LIKE CASE WHEN ~[gpv:sch] = 0 THEN '%' ELSE '~[gpv:sch]' END
                    AND s.dcid NOT IN (SELECT StudentsDCID FROM GuardianStudent)
                    ORDER BY Upper(Trim(s.Last_Name)), Upper(Trim(s.First_Name))
                    ;alternatecolor;nonemessage=
                    <tr>
                        <td colspan="100%">No records were found.</td>
                    </tr>]
                    <tr class="Record" data-StudentID="~(dcid)">
                        <td>~(s.student_number)</td>
                        <td>~(s.last_name)</td>
                        <td>~(s.first_name)</td>
                        <td>~(school)</td>
                        <td>~(s.grade_level)</td>
                        <td>~(Parent_Access_Disabled)</td>
                        <td>~(Student_Access_Disabled)</td>
                    </tr>
                    [/tlist_sql]
                </tbody>
            </table>
        </div>
        <!-- End of results -->
        <div>
            <p>
                <center>Report generated at ~[time] on ~[date]</center>
            </p>
        </div>
        [/if#showData]
        ~[wc:admin_footer_frame_css]
    </body>

</html>